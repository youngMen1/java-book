# 第08课：Shell 如何来实现系统初始化

本课时我们开始进入一个新的课程模块（部署），在这部分我将首先讲解 Shell 如何实现系统初始化，通过 Shell 脚本集成 Linux 操作命令对操作系统进行初始化。

## Shell 脚本简介

### Shell 初始化脚本 Jinit 介绍

首先，这里给你演示一个叫作“Jinit”的脚本，它是用 Shell 实现的系统初始化脚本，它实现了 OS 所需的系统参数优化、运维优化、安全优化、自动化任务等多方面的功能。接下来我会登录到刚装好的一台新的主机，在系统上执行演示这个脚本。



首先 cd 到程序代码目录下，在代码目录下有两个脚本，一个是 Jinit.sh，这是操作系统的初始化脚本，也是我们本课时所需要讲解的；另外一个是 autoconfigip.sh，用于自动配置 IP。

我们往往在安装完操作系统以后，IP 地址可能是动态获取或临时的，所以需要把操作系统临时获取的静态 IP 进行一个 IP 地址配置，autoconfigip.sh 就是用来完成这个工作的，Jinit.sh 会调用并执行脚本。



你可以看下执行效果，在执行过程中，首先输出一些命令所操作的记录。执行完之后，重启主机再次登录，这里需要补充一下，因为我的操作系统是 CentOS 7（这个脚本也是为Centos7准备的），如果你的操作系统不是 CentOS 7，需要根据系统差异对脚本内容进行一些修改。



接下来，重新登录主机，因为 Jinit.sh 脚本对 ssh 登录服务端口和登录方式进行了修改，所以需要用新的方式登录这台主机。这里执行 ssh root，新的主机端口改为 9922，我通过 9922 端口登录主机。



这时，旧密码不再能登录主机，所以需要输入重置后的新密码，接下来便可以登录主机了，你应该细心的 发现，登录主机后，展示的终端交互样式和之前有差异，原因是脚本修改了终端交互显示环境。 

## Shell 初始化脚本 Jinit 框架

刚才演示了 Jinit.sh 脚本的执行过程和执行结果，想必你想了解 Jinit.sh 脚本到底做了哪些系统的初始化，具体修改了哪些内容，接下来就给你详细讲解。
Cgq2xl5qC1-AJZ-eAAOMT2A6vD8550.png

首先，我们来看一下 Jinit.sh 脚本的整体结构。如果你了解 Shell 会发现，这是一种最基础的编写方式，Shell 会由上到下，依次执行每一段优化项。如果你想将脚本写得更好，建议你把优化项封装成函数，这样维护性更高。另外你也可以选择优先调用执行顺序.  

## 学习基础

学习这个脚本之前，你需要有一定的 Linux 操作基础，同时需要了解基础的操作系统原理，接下来，给你画了一张思维导图。