# 第15课：服务向 Kubernetes 容器平台迁移必须了解的事情

本课时我们讲解：服务向 Kubernetes 容器平台迁移必须了解的知识点。我将这个课时分为两个模块，第 1 个模块会列出一个服务，在非容器化的 K8S 架构下，要向 K8S+ 容器的架构迁移需要了解的一些相关问题。第 2 个模块中我将为你介绍通用的迁移步骤。

学习本课时之前，你需要先了解 K8S 的一些基础知识，也需要了解容器相关的一些操作基础内容。

## 业务迁移到 K8S 需要关注的问题

我们先来学习第 1 个模块：业务迁移到 K8S 所需要关注的问题，这里我罗列了几个相关的问题：

### 程序中有状态的内容

第一点，我们需要关注程序中已有状态的数据存放。因为传统方式开发程序通常会保存一些本地化的数据，我们称它为一个本地有状态的服务，比如业务节点内存中保存用户登录所需的 Session 数据，这种数据经常被保存在本地节点所开辟的一块内存空间里。

为什么需要关注程序中有状态的这些内容呢？这是因为程序迁移到 K8S 的架构下，K8S 调度需要对 Pod 节点的弹性扩缩或资源调度。如果服务固定依赖本地存储空间数据，那么就可能出现因为 K8S 的调度导致这部分已经存储在本地的数据丢失，因为启用新的业务 pod，无法读取原有的 pod 上的数据。这时我们需要将数据在本地做无状态化。

Ciqah16MTOCAHEBfAAPnCtCdK5Y628.png

以上就是在迁移到 K8S 之前所需要重点考虑的第一个问题，如何解决呢？就需要将业务服务做到本地无状态化，这里我画了一张图。


当请求到达业务服务后，业务服务会把这部分有状态的信息数据存储到一个公共的服务组件里去，而不是放在业务服务本地资源的空间里，比如我们可以把数据存储在数据库、消息队列、分布式存储里。

Ciqah16MTOCAQCSAAAKhbPhNDg4966.png